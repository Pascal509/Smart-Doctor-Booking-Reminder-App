{"ast":null,"code":"import { ApiError, API_BASE_URL } from '../types/api';\nimport { getAuthHeader } from '../utils/tokenStorage';\n\n/**\n * Fetches doctors by specialty ID from the backend API\n * \n * @param specialtyId - The ID of the specialty to filter doctors by\n * @returns Promise<Doctor[]> - Array of doctors for the specified specialty\n * @throws ApiError - When the API request fails or returns an error\n * \n * OpenAPI Specification:\n * GET /api/v1/doctors?specialty_id={specialtyId}\n * \n * Success Response (200):\n * {\n *   \"message\": \"Doctors retrieved successfully\",\n *   \"data\": Doctor[]\n * }\n * \n * Error Response (404):\n * {\n *   \"error\": \"Not Found\",\n *   \"message\": \"No doctors found for the specified specialty\"\n * }\n */\nexport async function fetchDoctorsBySpecialty(specialtyId) {\n  // Validate input\n  if (!specialtyId || specialtyId <= 0) {\n    throw new ApiError('Invalid specialty ID. Must be a positive number.', 400);\n  }\n  const url = `${API_BASE_URL}/doctors?specialty_id=${specialtyId}`;\n  try {\n    const headers = {\n      'Content-Type': 'application/json'\n    };\n    const authHeader = getAuthHeader();\n    if (authHeader) {\n      headers['Authorization'] = authHeader;\n    }\n    const response = await fetch(url, {\n      method: 'GET',\n      headers\n    });\n\n    // Handle different HTTP status codes\n    if (!response.ok) {\n      const errorData = await response.json().catch(() => ({\n        error: 'Unknown Error',\n        message: `HTTP ${response.status}: ${response.statusText}`\n      }));\n\n      // Handle specific 404 case\n      if (response.status === 404) {\n        throw new ApiError(`No doctors found for specialty ID ${specialtyId}`, 404, errorData);\n      }\n\n      // Handle other error status codes\n      throw new ApiError(errorData.message || `Request failed with status ${response.status}`, response.status, errorData);\n    }\n\n    // Parse successful response\n    const apiResponse = await response.json();\n\n    // Validate response structure\n    if (!apiResponse.data || !Array.isArray(apiResponse.data)) {\n      throw new ApiError('Invalid response format from server', 500);\n    }\n    return apiResponse.data;\n  } catch (error) {\n    // Re-throw ApiError instances\n    if (error instanceof ApiError) {\n      throw error;\n    }\n\n    // Handle network errors and other exceptions\n    if (error instanceof TypeError && error.message.includes('fetch')) {\n      throw new ApiError('Network error: Unable to connect to the server. Please check your internet connection.', 0);\n    }\n\n    // Handle JSON parsing errors\n    if (error instanceof SyntaxError) {\n      throw new ApiError('Server returned invalid response format', 500);\n    }\n\n    // Handle unknown errors\n    throw new ApiError(`Unexpected error: ${error instanceof Error ? error.message : 'Unknown error occurred'}`, 500);\n  }\n}\n\n/**\n * Alternative implementation using axios (commented out)\n * Uncomment and install axios if preferred: npm install axios\n */\n/*\nimport axios, { AxiosError } from 'axios';\n\nexport async function fetchDoctorsBySpecialtyAxios(specialtyId: number): Promise<Doctor[]> {\n  if (!specialtyId || specialtyId <= 0) {\n    throw new ApiError('Invalid specialty ID. Must be a positive number.', 400);\n  }\n\n  try {\n    const response = await axios.get<ApiResponse<Doctor[]>>(\n      `${API_BASE_URL}/doctors`,\n      {\n        params: { specialty_id: specialtyId },\n        headers: {\n          ...(getAuthToken() && { 'Authorization': `Bearer ${getAuthToken()}` })\n        }\n      }\n    );\n\n    return response.data.data;\n\n  } catch (error) {\n    if (axios.isAxiosError(error)) {\n      const axiosError = error as AxiosError<ErrorResponse>;\n      \n      if (axiosError.response?.status === 404) {\n        throw new ApiError(\n          `No doctors found for specialty ID ${specialtyId}`,\n          404,\n          axiosError.response.data\n        );\n      }\n\n      throw new ApiError(\n        axiosError.response?.data?.message || axiosError.message,\n        axiosError.response?.status || 500,\n        axiosError.response?.data\n      );\n    }\n\n    throw new ApiError(\n      `Unexpected error: ${error instanceof Error ? error.message : 'Unknown error occurred'}`,\n      500\n    );\n  }\n}\n*/\n\n/**\n * Helper function to get authentication token from secure storage\n * Uses the centralized token storage utility\n */\nfunction getAuthToken() {\n  const authHeader = getAuthHeader();\n  return authHeader ? authHeader.replace('Bearer ', '') : null;\n}\n\n/**\n * Example usage:\n * \n * try {\n *   const doctors = await fetchDoctorsBySpecialty(5);\n *   console.log('Doctors found:', doctors);\n * } catch (error) {\n *   if (error instanceof ApiError) {\n *     if (error.status === 404) {\n *       console.log('No doctors found for this specialty');\n *     } else {\n *       console.error('API Error:', error.message);\n *     }\n *   }\n * }\n */","map":{"version":3,"names":["ApiError","API_BASE_URL","getAuthHeader","fetchDoctorsBySpecialty","specialtyId","url","headers","authHeader","response","fetch","method","ok","errorData","json","catch","error","message","status","statusText","apiResponse","data","Array","isArray","TypeError","includes","SyntaxError","Error","getAuthToken","replace"],"sources":["C:/Users/HP/Smart-Doctor-Booking-Reminder-App/frontend/src/services/doctorApi.ts"],"sourcesContent":["import { ApiResponse, Doctor, ErrorResponse, ApiError, API_BASE_URL } from '../types/api';\nimport { getAuthHeader } from '../utils/tokenStorage';\n\n/**\n * Fetches doctors by specialty ID from the backend API\n * \n * @param specialtyId - The ID of the specialty to filter doctors by\n * @returns Promise<Doctor[]> - Array of doctors for the specified specialty\n * @throws ApiError - When the API request fails or returns an error\n * \n * OpenAPI Specification:\n * GET /api/v1/doctors?specialty_id={specialtyId}\n * \n * Success Response (200):\n * {\n *   \"message\": \"Doctors retrieved successfully\",\n *   \"data\": Doctor[]\n * }\n * \n * Error Response (404):\n * {\n *   \"error\": \"Not Found\",\n *   \"message\": \"No doctors found for the specified specialty\"\n * }\n */\nexport async function fetchDoctorsBySpecialty(specialtyId: number): Promise<Doctor[]> {\n  // Validate input\n  if (!specialtyId || specialtyId <= 0) {\n    throw new ApiError('Invalid specialty ID. Must be a positive number.', 400);\n  }\n\n  const url = `${API_BASE_URL}/doctors?specialty_id=${specialtyId}`;\n  \n  try {\n    const headers: Record<string, string> = {\n      'Content-Type': 'application/json'\n    };\n    \n    const authHeader = getAuthHeader();\n    if (authHeader) {\n      headers['Authorization'] = authHeader;\n    }\n    \n    const response = await fetch(url, {\n      method: 'GET',\n      headers,\n    });\n\n    // Handle different HTTP status codes\n    if (!response.ok) {\n      const errorData: ErrorResponse = await response.json().catch(() => ({\n        error: 'Unknown Error',\n        message: `HTTP ${response.status}: ${response.statusText}`\n      }));\n\n      // Handle specific 404 case\n      if (response.status === 404) {\n        throw new ApiError(\n          `No doctors found for specialty ID ${specialtyId}`,\n          404,\n          errorData\n        );\n      }\n\n      // Handle other error status codes\n      throw new ApiError(\n        errorData.message || `Request failed with status ${response.status}`,\n        response.status,\n        errorData\n      );\n    }\n\n    // Parse successful response\n    const apiResponse: ApiResponse<Doctor[]> = await response.json();\n    \n    // Validate response structure\n    if (!apiResponse.data || !Array.isArray(apiResponse.data)) {\n      throw new ApiError('Invalid response format from server', 500);\n    }\n\n    return apiResponse.data;\n\n  } catch (error) {\n    // Re-throw ApiError instances\n    if (error instanceof ApiError) {\n      throw error;\n    }\n\n    // Handle network errors and other exceptions\n    if (error instanceof TypeError && error.message.includes('fetch')) {\n      throw new ApiError(\n        'Network error: Unable to connect to the server. Please check your internet connection.',\n        0\n      );\n    }\n\n    // Handle JSON parsing errors\n    if (error instanceof SyntaxError) {\n      throw new ApiError(\n        'Server returned invalid response format',\n        500\n      );\n    }\n\n    // Handle unknown errors\n    throw new ApiError(\n      `Unexpected error: ${error instanceof Error ? error.message : 'Unknown error occurred'}`,\n      500\n    );\n  }\n}\n\n/**\n * Alternative implementation using axios (commented out)\n * Uncomment and install axios if preferred: npm install axios\n */\n/*\nimport axios, { AxiosError } from 'axios';\n\nexport async function fetchDoctorsBySpecialtyAxios(specialtyId: number): Promise<Doctor[]> {\n  if (!specialtyId || specialtyId <= 0) {\n    throw new ApiError('Invalid specialty ID. Must be a positive number.', 400);\n  }\n\n  try {\n    const response = await axios.get<ApiResponse<Doctor[]>>(\n      `${API_BASE_URL}/doctors`,\n      {\n        params: { specialty_id: specialtyId },\n        headers: {\n          ...(getAuthToken() && { 'Authorization': `Bearer ${getAuthToken()}` })\n        }\n      }\n    );\n\n    return response.data.data;\n\n  } catch (error) {\n    if (axios.isAxiosError(error)) {\n      const axiosError = error as AxiosError<ErrorResponse>;\n      \n      if (axiosError.response?.status === 404) {\n        throw new ApiError(\n          `No doctors found for specialty ID ${specialtyId}`,\n          404,\n          axiosError.response.data\n        );\n      }\n\n      throw new ApiError(\n        axiosError.response?.data?.message || axiosError.message,\n        axiosError.response?.status || 500,\n        axiosError.response?.data\n      );\n    }\n\n    throw new ApiError(\n      `Unexpected error: ${error instanceof Error ? error.message : 'Unknown error occurred'}`,\n      500\n    );\n  }\n}\n*/\n\n/**\n * Helper function to get authentication token from secure storage\n * Uses the centralized token storage utility\n */\nfunction getAuthToken(): string | null {\n  const authHeader = getAuthHeader();\n  return authHeader ? authHeader.replace('Bearer ', '') : null;\n}\n\n/**\n * Example usage:\n * \n * try {\n *   const doctors = await fetchDoctorsBySpecialty(5);\n *   console.log('Doctors found:', doctors);\n * } catch (error) {\n *   if (error instanceof ApiError) {\n *     if (error.status === 404) {\n *       console.log('No doctors found for this specialty');\n *     } else {\n *       console.error('API Error:', error.message);\n *     }\n *   }\n * }\n */"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}